飞旗全流量回溯分析系统V1.0

1. 引言

1.1 编写目的

本文档是飞旗全流量回溯分析系统V1.0的用户操作手册，旨在详细说明系统各功能模块的使用方法与操作流程。文档面向系统管理员、安全分析人员及运维工程师，帮助用户全面了解系统的功能布局、操作逻辑和业务流程。通过本文档，用户可以快速掌握系统总览监控、全时域流量存储、会话重建还原、多维关联溯源、攻击路径推演、隐性资产发现、加密流量识别、流量指纹管理、智能回溯分析、取证报告生成、可视化回溯分析以及平台管理调度等核心功能的具体操作方法，从而高效利用系统完成网络安全审计、攻击溯源与业务取证等各项工作任务。本文档同时作为系统验收与培训的参考依据。

1.2 项目背景

随着网络安全威胁日趋复杂化与隐蔽化，传统的基于实时告警的安全防护体系已难以满足深度攻击溯源与事后取证的需求。高级持续性威胁、加密隧道通信、横向渗透移动等新型攻击手段不断涌现，要求安全团队具备对历史全量流量进行回溯检索、会话级重建与智能关联分析的能力。同时，国家网络安全法规与行业合规要求日益严格，企业需要保留完整的网络流量记录并具备可追溯、可取证的闭环能力。在此背景下，飞旗全流量回溯分析系统V1.0应运而生。

本系统由上海飞旗网络股份有限公司自主研发，面向网络安全审计、攻击溯源、业务取证与异常行为分析等核心场景。系统通过部署分布式采集探针，实现对网络全量流量的持续捕获与长期留存，存储容量可达PB级别。在此基础上，系统构建了时序索引分层存储架构，支持秒级检索与任意时间点的会话回放能力。系统集成了多维关联溯源、攻击路径自动推演、加密流量智能识别、流量指纹基因匹配等先进分析引擎，通过人工智能技术实现对历史威胁的自动回溯与未知变种的识别发现。

本系统采用前后端分离的现代化架构设计，具备高可用、可扩展的分布式部署能力。前端采用组件化开发模式，提供响应式的可视化操作界面。系统共包含十一个核心功能模块，覆盖从流量采集存储、会话重建还原、关联溯源分析到取证报告生成的完整业务链条。平台管理模块提供节点管理、任务调度、系统备份与操作审计等运维管理能力，保障系统的稳定运行。本系统致力于为用户打造"可查询、可还原、可关联、可溯源"的全方位网络安全回溯分析平台，为网络安全防护体系提供坚实的取证底座与分析支撑。

2. 软件概述

2.1 目的与功能

本系统旨在构建面向网络安全领域的深度流量回溯分析平台，实现PB级流量高效存储与秒级检索、任意时间点会话回放与业务还原、跨维度关联分析与攻击路径推演、加密流量智能识别与历史威胁自动回溯、司法级电子取证报告生成等核心能力，为安全审计与攻击溯源提供完整的闭环支撑。

2.2 技术特点

系统采用时序索引分层存储架构，支持冷热数据自动分层与分布式横向扩展。前端采用组件化开发与响应式设计，提供深色主题可视化交互界面。后端基于流式计算与图谱分析引擎，结合人工智能模型实现异常检测与指纹匹配。系统支持分布式节点部署、负载均衡调度与增量备份策略，具备高可用与高扩展能力。

4.1 总览

功能说明：系统总览页面是整个平台的核心监控入口，集中展示当前系统的运行状态与关键指标。页面上方呈现今日流量总量、活跃会话数、安全事件数、威胁告警数、探针节点状态及加密流量占比六项核心统计指标，下方设置流量趋势图表、协议分布图、实时威胁事件列表以及功能模块导航网格。

4.1.1 流量趋势监控

功能说明：流量趋势监控以面积图形式展示过去二十四小时的网络流量分布情况，包含入站流量与出站流量两条趋势曲线。图表横轴为时间刻度，纵轴为流量大小，支持鼠标悬停查看各时间点的详细数值。右侧同时展示各协议流量占比的水平柱状图，涵盖主流网络协议的流量统计数据。

操作步骤：进入系统总览页面，在页面中部可见流量趋势监控区域。将鼠标移至图表上方，即可查看对应时间点的入站与出站流量数值。右侧协议分布图同步展示各协议的流量占比情况。

4.1.2 实时威胁事件

功能说明：实时威胁事件面板以滚动列表形式展示当前系统检测到的安全威胁事件。每条事件记录包含事件编号、威胁类型、源地址与目标地址、发生时间等信息，并通过颜色标签标识严重、高危、中危、低危四个威胁等级，帮助安全人员快速识别关键威胁并优先处置。

操作步骤：在总览页面下方左侧区域查看实时威胁事件列表。列表按时间倒序排列，最新事件显示在最上方。通过颜色标签可快速区分威胁等级，点击各功能模块卡片可跳转至对应模块详情页面。

4.2 全时域流量存储引擎

功能说明：全时域流量存储引擎采用时序索引分层架构，实现网络全量流量的长期留存与秒级回溯检索。页面顶部展示存储总量、今日写入量、平均检索延迟及存储节点数四项核心指标，下方提供存储写入趋势图、冷热数据分布图以及支持增删改查操作的检索规则管理表格。

4.2.1 存储写入趋势

功能说明：存储写入趋势以面积图展示过去二十四小时的数据写入与读取变化情况。实线表示写入量，虚线表示读取量，纵轴单位为TB。通过该图表可直观了解流量采集的时间分布特征，识别流量高峰与低谷时段，为存储容量规划与资源调度提供数据依据。图表支持鼠标悬停查看精确数值。

操作步骤：进入全时域流量存储引擎页面，在统计卡片下方即可查看存储写入趋势图表。将鼠标悬停至图表曲线上方，系统将显示该时间点的写入量与读取量详细数值信息。

4.2.2 冷热数据分布

功能说明：冷热数据分布以环形饼图直观展示当前存储系统中热数据、温数据与冷数据的占比情况。热数据为近期高频访问数据，温数据为中期偶发访问数据，冷数据为长期归档数据。该分布图反映了系统自动分层存储策略的执行效果，帮助运维人员评估存储资源利用率并优化分层策略。

操作步骤：在存储写入趋势图右侧查看冷热数据分布饼图。图表下方显示各层级数据的名称与占比百分数。将鼠标悬停至饼图扇区上方，可查看对应数据层级的详细占比数值信息。

4.2.3 新增检索规则

功能说明：检索规则管理支持用户创建、编辑、删除和搜索检索规则。新增检索规则功能允许用户定义流量检索的查询条件、设置最大返回记录数与执行状态。通过规则化的检索管理，用户可将常用查询保存为规则条目，提高日常检索效率，避免重复输入复杂的查询语句。

操作步骤：在检索规则列表上方点击"新增检索规则"按钮，系统弹出新增对话框。在表单中输入查询条件，选择最大返回记录数和状态，点击"确认新增"按钮完成创建。新规则将显示在列表最上方。

4.3 会话重建与业务还原中心

功能说明：会话重建与业务还原中心支持对网络会话的完整重建，涵盖HTTP、FTP、邮件、数据库等多种协议。页面展示今日重建会话数、重建成功率、支持协议数及活跃任务数四项统计指标，提供会话重建趋势图、协议分布图以及支持增删改查的重建任务管理表格。

4.3.1 会话重建趋势

功能说明：会话重建趋势图以面积图形式展示过去二十四小时的会话重建数量变化。实线代表成功重建的会话数量，虚线代表失败会话数量。通过该图表可监控系统的重建处理能力和故障情况，当失败会话异常增多时可及时排查原因。

操作步骤：进入会话重建与业务还原中心页面，在统计卡片下方查看会话重建趋势图表。鼠标悬停至曲线可查看各时间点的重建会话数与失败会话数的详细数值。

4.3.2 新增重建任务

功能说明：新增重建任务功能支持用户手动创建会话重建任务。用户可选择目标协议类型，指定源地址与目标地址，设置任务执行状态。系统根据配置参数执行TCP重组、应用层协议解析与业务对象还原，将原始流量还原为可读的文件、邮件、请求等业务对象。

操作步骤：在重建任务列表上方点击"新增重建任务"按钮，在弹出对话框中选择协议类型，输入源地址与目标地址，选择任务状态后点击"确认新增"按钮完成任务创建。

4.3.3 协议分布

功能说明：协议分布以环形饼图展示当前系统中各协议类型的会话占比情况，包括HTTPS、HTTP、FTP、SMTP及其他协议。该图表反映了网络业务的协议构成特征，帮助分析人员了解网络流量的业务类型分布，为安全策略制定提供参考依据。

操作步骤：在会话重建趋势图右侧查看协议分布饼图。图表下方标注各协议名称与对应占比百分数。将鼠标悬停至饼图对应扇区，可查看该协议类型的详细占比数值信息。

4.4 多维关联溯源中心

功能说明：多维关联溯源中心实现IP地址、用户账号、终端设备、域名、文件等多维度实体的跨维度关联分析。页面展示关联实体总数、溯源链条数、关键节点数及活跃分析数四项统计指标，提供关联分析趋势图、实体类型分布图以及支持增删改查的溯源任务管理表格。

4.4.1 关联分析趋势

功能说明：关联分析趋势图展示过去二十四小时新增实体与新增关联关系的变化情况。实线表示新增实体数量，虚线表示新增关联关系数量，可直观反映系统关联分析引擎的运行强度与发现能力。

操作步骤：进入多维关联溯源中心页面，在统计卡片下方查看关联分析趋势图。鼠标悬停至曲线可查看各时间点的新增实体数与新增关联数的详细信息。

4.4.2 实体类型分布

功能说明：实体类型分布以环形饼图展示系统中各类实体的占比情况，包括IP地址、用户账号、终端设备、域名和文件五类实体。该图表反映了当前关联分析中各维度实体的构成比例。

操作步骤：在关联分析趋势图右侧查看实体类型分布饼图。图表下方标注各实体类型名称与占比百分数。鼠标悬停至饼图扇区可查看详细数值。

4.4.3 新增溯源任务

功能说明：新增溯源任务功能支持用户创建跨维度关联分析任务。用户指定源实体与目标实体，选择关联维度（登录行为、DNS解析、文件传输、VPN接入、C2通信、异常外联、端口扫描），系统自动执行关联分析。

操作步骤：点击"新增溯源任务"按钮，在弹出对话框中填写信息后确认提交。

4.4.4 编辑溯源任务

功能说明：编辑功能支持用户修改已有溯源任务的源实体、目标实体、关联维度及状态等配置信息。

操作步骤：点击目标记录操作列的编辑图标按钮，修改后保存。

4.4.5 删除溯源任务

功能说明：删除功能允许用户移除不再需要的溯源任务记录，删除前系统弹出二次确认对话框防止误操作。

操作步骤：点击目标记录操作列的删除图标按钮，确认后删除。

4.5 攻击路径推演中心

功能说明：攻击路径推演中心自动生成攻击链路与横向移动路径。页面展示检测攻击链数、横向移动次数、高危路径数及推演任务数四项统计指标，提供攻击检测趋势图、攻击阶段分布图以及近期攻击路径列表，帮助安全人员全面掌握攻击态势。

4.5.1 攻击检测趋势

功能说明：攻击检测趋势图以面积图展示过去二十四小时攻击事件与已阻断事件的变化情况。实线表示检测到的攻击事件，虚线表示已阻断事件，通过两条曲线的对比可评估安全防护的拦截效果。

操作步骤：进入攻击路径推演中心页面，在统计卡片下方查看攻击检测趋势图。鼠标悬停至曲线可查看各时间点的攻击事件数与已阻断数的详细数值。

4.5.2 攻击阶段分布

功能说明：攻击阶段分布以环形饼图展示当前检测到的攻击事件在各攻击阶段的占比，包括侦察探测、初始入侵、横向移动、权限提升和数据窃取五个阶段，帮助分析人员判断攻击者的主要活动阶段。

操作步骤：在攻击检测趋势图右侧查看攻击阶段分布饼图。图表下方标注各阶段名称与占比百分数。鼠标悬停至饼图扇区可查看对应阶段的详细数值。

4.5.3 近期攻击路径

功能说明：近期攻击路径以数据表格形式展示系统检测到的攻击链路详情，包括攻击源、目标、攻击阶段、涉及主机数、风险等级及推演状态。风险等级通过颜色标签区分严重、高危、中危等级别。

操作步骤：在页面下方查看近期攻击路径数据表格，各列展示攻击链路的详细信息。风险等级列以彩色标签直观标识威胁级别，状态列显示当前推演进展情况。

4.6 隐性资产发现中心

功能说明：隐性资产发现中心通过流量被动识别未登记资产与影子系统。页面展示已发现资产数、未登记资产数、高风险资产数及指纹识别率四项统计指标，提供资产发现趋势图、资产类型分布图以及支持增删改查操作的资产信息管理表格，帮助用户全面掌握网络资产状况。

4.6.1 资产发现趋势

功能说明：资产发现趋势图以面积图展示过去二十四小时新发现资产与已登记资产的变化情况。实线表示新发现资产数，虚线表示已完成登记的资产数，可直观反映资产发现引擎的运行效果与登记处理进度。

操作步骤：进入隐性资产发现中心页面，在统计卡片下方查看资产发现趋势图。鼠标悬停至曲线可查看各时间点的新发现资产数与已登记资产数详细信息。

4.6.2 新增资产信息

功能说明：新增资产信息功能支持用户手动录入发现的网络资产。表单包含IP地址、资产类型（服务器、IoT设备、网络设备、终端设备、其他）、操作系统或服务信息、开放端口、风险等级及登记状态等字段。

操作步骤：在资产列表上方点击"新增资产信息"按钮，在弹出对话框中填写IP地址、选择资产类型、输入系统服务与端口信息、设置风险等级与登记状态，点击"确认新增"。

4.6.3 编辑资产信息

功能说明：编辑功能允许用户修改已有资产记录的各项属性信息，包括IP地址、资产类型、操作系统服务、开放端口、风险等级及登记状态等字段。

操作步骤：点击目标资产记录操作列的编辑图标，修改后保存。

4.6.4 删除资产信息

功能说明：删除功能允许用户移除不再需要的资产记录。删除前系统弹出二次确认对话框，用户确认后方可执行删除操作，防止误删除。

操作步骤：点击目标资产记录操作列的删除图标，确认后删除。

4.7 加密流量智能识别中心

功能说明：加密流量智能识别中心基于人工智能与统计特征识别加密流量中的异常行为。页面展示加密流量占比、异常检测数、C2通信嫌疑数及隐蔽隧道数四项统计指标，提供加密流量分析趋势图、加密协议分布图以及近期异常告警列表，涵盖C2通信特征、隐蔽隧道、异常JA3指纹、DGA域名等多种威胁检测。

操作步骤：进入加密流量智能识别中心页面，顶部查看统计指标卡片。中部左侧面积图展示加密流量与异常流量的时序变化，右侧饼图展示各加密协议的占比分布。下方异常告警表格列出各条告警的源目地址、异常类型、置信度与风险评分。

4.8 流量指纹基因库

功能说明：流量指纹基因库构建应用与攻击流量的DNA指纹特征库，实现对已知与未知流量的快速识别匹配。页面展示指纹总数、今日匹配数、新增指纹数及未知变种数四项统计指标，提供指纹匹配趋势图、指纹类别分布图以及支持增删改查的指纹规则管理表格。

4.8.1 新增指纹规则

功能说明：新增指纹规则功能允许用户向基因库中添加新的流量指纹特征。表单包含指纹ID、类别（Web应用、恶意软件、IoT协议、隧道工具、其他）、匹配特征描述、关联来源IP及状态等字段，支持对新发现的流量特征进行规则化入库。

操作步骤：在指纹规则列表上方点击"新增指纹规则"按钮，在弹出对话框中输入指纹ID、选择类别、填写匹配特征描述与关联来源IP、设置状态，点击"确认新增"完成规则创建。

4.8.2 编辑指纹规则

功能说明：编辑功能支持用户修改已有指纹规则的类别、匹配特征描述、关联来源IP及状态等属性，用于优化指纹匹配的准确率与覆盖范围。

操作步骤：在指纹规则列表中找到目标记录，点击操作列的编辑图标按钮，修改相关字段后保存。

4.8.3 删除指纹规则

功能说明：删除功能允许用户移除过时或无效的指纹规则。删除前系统弹出二次确认对话框，用户确认后方可执行删除，防止误删有效规则。

操作步骤：在指纹规则列表中找到目标记录，点击操作列的删除图标按钮，在确认对话框中点击确认。

4.9 智能回溯分析引擎

功能说明：智能回溯分析引擎支持"事后发现威胁、自动回溯历史流量"的分析模式。页面展示回溯任务数、发现威胁数、历史匹配数及补救触发数四项统计指标，提供回溯分析趋势图、威胁类型分布图以及支持增删改查的回溯任务管理表格，实现对历史流量中潜伏威胁的批量发现。

4.9.1 新增回溯任务

功能说明：新增回溯任务功能支持用户创建基于新威胁特征的历史流量回溯分析任务。用户输入威胁特征描述，选择回溯时段（近七天至近九十天），填写预估影响范围并设置任务状态，系统将在历史流量中执行批量特征匹配。

操作步骤：在回溯任务列表上方点击"新增回溯任务"按钮，在弹出对话框中输入威胁特征、选择回溯时段、填写影响范围、设置状态后点击"确认新增"按钮完成任务创建。

4.9.2 编辑回溯任务

功能说明：编辑功能支持用户修改已有回溯任务的威胁特征、回溯时段、影响范围及执行状态等配置参数，用于调整分析范围或更新威胁特征信息。

操作步骤：点击目标回溯任务操作列的编辑图标按钮，在对话框中修改相关字段后点击保存。

4.9.3 删除回溯任务

功能说明：删除功能允许用户移除已完成或不再需要的回溯任务记录。删除前系统弹出二次确认对话框，用户确认后方可执行删除操作。

操作步骤：点击目标回溯任务操作列的删除图标按钮，在确认对话框中点击确认删除。

4.9.4 回溯分析趋势

功能说明：回溯分析趋势图以面积图展示过去二十四小时的流量扫描量与威胁发现量变化情况。实线表示扫描的历史流量规模，虚线表示发现的威胁数量，通过两条曲线的对比可评估回溯引擎的分析效率。

操作步骤：进入智能回溯分析引擎页面，在统计卡片下方查看回溯分析趋势图。鼠标悬停至曲线可查看各时间点扫描流量规模与发现威胁数量的详细数值信息。

4.9.5 威胁类型分布

功能说明：威胁类型分布以环形饼图展示回溯分析发现的各类威胁占比，包括APT攻击、恶意软件、数据泄露、C2通信及其他类型。该图表帮助安全人员了解历史威胁的构成特征，为安全策略调整提供依据。

操作步骤：在回溯分析趋势图右侧查看威胁类型分布饼图。图表下方标注各威胁类型名称与占比百分数。鼠标悬停至饼图扇区可查看对应威胁类型的详细数值。

4.10 取证与报告生成中心

功能说明：取证与报告生成中心提供一键生成可司法取证的流量证据报告能力。页面展示报告总数、证据条目数、今日导出数及活跃案例数四项指标，提供报告生成趋势图、证据类型分布图以及近期报告列表，支持PDF、CSV、HTML、JSON等多种格式导出。

操作步骤：进入取证与报告生成中心页面，查看统计指标与趋势图表。下方报告列表展示各报告的案例名称、类型、证据数量及导出格式等详细信息。

4.11 可视化回溯分析中心

功能说明：可视化回溯分析中心提供时间轴式回溯分析界面，支持拖拽式回放与多维过滤。页面展示回溯会话数、时间轴事件数、活跃分析数及过滤规则数四项指标，提供分析会话趋势图、事件类型分布图以及近期分析任务列表，记录每个分析任务的目标、时段、事件数与负责分析师。

操作步骤：进入可视化回溯分析中心页面，顶部查看统计指标。中部图表展示分析会话时序趋势与事件类型占比分布。下方表格列出各分析任务的详细信息，包括分析目标、回溯时段、关联事件数、会话数及当前分析状态。

4.12 平台管理与资源调度中心

功能说明：平台管理与资源调度中心是系统的运维管理中枢，实现分布式回溯任务调度与资源优化管理。页面展示探针节点数、CPU使用率、存储使用率及活跃任务数四项核心指标，下方设置节点管理、任务调度、系统备份、操作审计四个管理面板，通过标签页方式切换。

4.12.1 节点管理

功能说明：节点管理面板提供对系统所有探针与计算节点的全生命周期管理能力。支持新增、编辑、删除和搜索节点操作，每个节点记录包含节点编号、名称、IP地址、节点类型、CPU使用率、内存使用率、存储使用率及运行状态。节点类型涵盖采集节点、存储节点、分析节点、索引节点和备份节点五类。

4.12.1.1 新增节点

功能说明：新增节点功能支持管理员向系统中注册新的探针或计算节点。表单包含节点名称、IP地址、节点类型和初始状态四个配置字段。

操作步骤：在节点管理面板点击"新增节点"按钮，在弹出对话框中输入节点名称与IP地址，选择节点类型与状态，点击"确认新增"完成节点注册。

4.12.1.2 编辑节点

功能说明：编辑节点功能支持管理员修改已有节点的名称、IP地址、类型及运行状态等配置信息。

操作步骤：在节点列表中找到目标节点，点击操作列的编辑图标按钮，在对话框中修改相关字段后点击"保存修改"。

4.12.1.3 删除节点

功能说明：删除节点功能允许管理员移除已下线或废弃的节点记录，删除前需二次确认。

操作步骤：点击目标节点操作列的删除图标按钮，在确认对话框中点击"确认删除"完成节点移除。

4.12.2 任务调度

功能说明：任务调度面板提供对分布式回溯任务的全面管理能力。支持新增、编辑、删除和搜索任务，并提供暂停、恢复、重试等快捷操作。每个任务记录包含任务编号、名称、类型、优先级、目标节点、创建时间及执行状态。底部统计栏实时显示运行中、排队中、已完成和失败任务的数量分布。

4.12.2.1 新增任务

功能说明：新增任务功能支持管理员创建回溯调度任务。表单包含任务名称、任务类型（流量回溯、会话重建、指纹匹配、威胁分析、数据备份）、优先级、目标节点及状态五个配置字段。

操作步骤：在任务调度面板点击"新增任务"按钮，在弹出对话框中填写任务名称，选择任务类型与优先级，指定目标节点与状态，点击"创建任务"完成调度任务的创建。

4.12.2.2 编辑任务

功能说明：编辑任务功能支持管理员修改已有调度任务的名称、类型、优先级、目标节点及执行状态等配置参数，用于调整任务调度策略或变更执行节点。

操作步骤：在任务列表中找到目标任务，点击操作列的编辑图标按钮，在弹出对话框中修改相关配置字段，点击"保存修改"按钮完成任务信息的更新。

4.12.2.3 删除任务

功能说明：删除任务功能允许管理员移除已完成或不再需要的调度任务记录。删除前系统弹出二次确认对话框，用户确认后方可执行删除，防止误删正在运行的任务。

操作步骤：在任务列表中找到目标任务，点击操作列的删除图标按钮，在弹出的确认对话框中点击"确认删除"按钮完成任务记录的移除操作。

4.12.3 系统备份

功能说明：系统备份面板提供备份管理功能，支持全量备份、增量备份和配置备份三种备份类型。面板以表格形式展示历史备份记录，每条记录包含备份编号、时间、类型、数据量、耗时及状态。管理员可一键创建新备份任务，也可删除过期的历史备份记录，搜索栏支持对备份记录的快速检索过滤。

4.12.3.1 创建备份

功能说明：创建备份功能支持管理员手动触发系统备份任务。表单提供备份类型选择（全量备份、增量备份、配置备份）和备份描述输入。创建后备份任务立即开始执行。

操作步骤：点击"创建备份"按钮，选择备份类型，填写描述后点击"立即备份"。

4.12.3.2 删除备份

功能说明：删除备份功能允许管理员清理过期或不再需要的历史备份记录。删除前系统弹出二次确认对话框，确认后执行删除操作释放存储空间。

操作步骤：点击目标备份记录的删除图标，在确认对话框中点击确认删除。

4.12.4 操作审计

功能说明：操作审计面板以只读方式记录系统内所有管理操作的完整日志，日志不可编辑和删除以确保审计完整性。每条记录包含操作时间、操作人、操作类型、操作对象、操作详情、操作IP及执行结果七个字段。面板提供关键字搜索功能，支持按操作人、类型、对象等维度快速过滤审计记录。

操作步骤：切换至"操作审计"标签页查看完整审计日志。在搜索框中输入关键字（如操作人姓名、操作类型或对象名称），系统实时过滤并展示匹配的审计记录，底部显示总记录数与筛选结果数。
